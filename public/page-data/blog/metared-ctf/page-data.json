{"componentChunkName":"component---src-templates-post-template-js","path":"/blog/metared-ctf/","result":{"data":{"markdownRemark":{"excerpt":"Last night mr. heker broke into our systems and stole our flag. All our communications are secure and we can’t tell how the data leave our network. I will send…","html":"<p>Last night mr. heker broke into our systems and stole our flag. All our communications are secure and we can’t tell how the data leave our network.</p>\n<blockquote>\n<p>I will send you an abnormal trace of communication. Please analize it and let me know if you figure it out. We need to get back that flag.\nBy the way. You know how mr. heker loves to play with people’s mind. He delivered a video with a creepy toy repeating the words “tic toc, tic toc”. I am not sure if it is a clue or just a silly game of him.\nCreator : Nandx</p>\n</blockquote>\n<p>Points to note :</p>\n<ul>\n<li>The PCAP File contains 418 ICMP Packets.</li>\n<li>ICMP : Internet Control Message Protocol</li>\n<li>The Hint the attacker left behind is a creepy toy that kept repeating **tic toc,tic toc **</li>\n</ul>\n<p><strong>The tic-toc part diverts the focus to the time of request.</strong></p>\n<p>Why Request? : Data is being exfiltrated here using the ICMP Protocol, so the replies can be disregarded.</p>\n<ol>\n<li>The attacker can control the time difference between the one packet and another.</li>\n</ol>\n<p>Therefore,</p>\n<p><em>View → Time display format → Seconds since previous captured packet and also change the format to only seconds.</em></p>\n<ol start=\"2\">\n<li>To see only the requests, apply the display filter</li>\n</ol>\n<p><em>icmp.type == 8</em></p>\n<p>Your display should look like this,</p>\n<p><img src=\"https://cdn-images-1.medium.com/max/2000/1*3JV7JLkI8L3qh5inBhYl0Q.png\" alt=\"\"></p>\n<ol start=\"3\">\n<li>Export the packet dissections.</li>\n</ol>\n<p><em>File → Export Packet Dissections → As CSV</em></p>\n<ol start=\"4\">\n<li>I have used pandas to extract only the time field data, you may use a tool of your choice or just continue with the pandas method.</li>\n</ol>\n<iframe src=\"https://medium.com/media/e77ca0019d75bd58b647d6740066616b\" frameborder=0></iframe>\n<p>On running the python file you should get a string of bits.</p>\n<p><img src=\"https://cdn-images-1.medium.com/max/2000/1*ukDVnMOeO0NuHJ8asR4WxA.png\" alt=\"\"></p>\n<p>Convert it to ASCII to find the flag.</p>\n<p><img src=\"https://cdn-images-1.medium.com/max/3060/1*3zJPxyJkLLX-8nCYMM9itQ.png\" alt=\"Believe me, you will get the flag.\"><em>Believe me, you will get the flag.</em></p>\n<p><strong>Why disregard the leading 0, (Notice that I have popped the first element from the pktimes list, in the python program. If I did not, I would have had a 0 there)</strong></p>\n<p>When I took the output without removing the leading 0, I got,</p>\n<p><img src=\"https://cdn-images-1.medium.com/max/2000/1*SsaqjVjYqehlM2gIHtAU3w.png\" alt=\"\"></p>\n<p><img src=\"https://cdn-images-1.medium.com/max/2000/1*7xkDYS9Dg85YaHv-zpAMlQ.png\" alt=\"\"></p>\n<p>There was one extra <strong>1</strong> in the end. So, I decided to remove the first <strong>0</strong>, since that is the time related to the first packet in the capture and the attacker would not have been able to manipulate it (It will remain 0.00000).</p>\n<p>Happy Hunting…</p>","frontmatter":{"title":"Data Exfiltration Challenge—CTF Internacional MetaRed 2021-3rd STAGE","tags":["ctf"],"date":"November 06, 2021","description":null}},"prev":null,"next":{"frontmatter":{"title":"Paths — A way into the future for everybody."},"fields":{"slug":"/blog/paths/"}}},"pageContext":{"slug":"/blog/metared-ctf/","prevSlug":null,"nextSlug":"/blog/paths/"}},"staticQueryHashes":["2555585279","3159585216","642215718"]}